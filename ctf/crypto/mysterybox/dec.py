#rsa chosen plaintext attack
import gmpy2

m = int("Username: Admin, Access code: CryptoBestCategoryF3".encode('hex'),16)
print 'admin message:'
print m
#print 2*m
#861934499667986621552658522992711737960484613144058684918624923247791760594840402997853247655770722704545163272571668019
#1723868999335973243105317045985423475920969226288117369837249846495583521189680805995706495311541445409090326545143336038

c2 = 88104372234011282552351081471121983555195097538839223493550423756739675727085302785735128475639276598945523319503154876822382699316989778904698512175368906849675130540532556353292398589268526347437510812422999480944654989422269144669494813811469887381635289769718499174674211787478303267310293290923172753467
c4 = 89179727302123131129536342576714869854031864685596599880552937995208252709625327798418591120628518169764056920575448020823035964237834643617506319718004939122373346245282868374801589740521406829742430396604757271666561559283603623554775742634105679897253289579779261612495204828519668733823392599393812880188
c8 = 70962763151271185200325926351715574240742887719474050379694727795466943163024213516672477492846715112828308226374901459772749497051940052099738879062274003499933048131240173345126488398930254608967582480980484253747743844264379839790419999716257338295261517214480030202559800259984879057114143245239174423239
c2m = 58135691303704611678618284840664898844880211957047544001865072263199606289397560782808500272889973554702067336059200095564303894733872510224537693011628030616946238447838558158248532265065978322990745219529294321671147999802411193489084899965077433771924527866611894030495675024997163504177955729766690578405

'''
c2 = 2**d%n
c4 = 4**d%n
c8 = 8**d%n

c2**2 - c4 = k1*n
c2**3 - c8 = k2*n
gcd( k1*n, k2*n) = n

c2m = 2m**d%n
2**-1*2m%n = m
c2**-1*c2m%n = cm
'''

m1 = c2**2 - c4
m2 = c2**3 - c8
#print m1
#print m2
n = gmpy2.gcd(m1,m2)
#print n
#121783120913122201823015978216995215619011873392951775797208638920211790793181085813818536788100887975654391973121512984462056413236296310514095850560746550103906996544817467083009942399941270748106392016051773883917906464332482298451603347174551093461680853421110049904138654834514260517220703305429057842849

cx2 = gmpy2.invert(c2,n)
print 'signature:'
print (cx2*c2m)%n

'''
Enter your option: 2
Enter your message as a decimal integer: 861934499667986621552658522992711737960484613144058684918624923247791760594840402997853247655770722704545163272571668019
Enter your signature as a decimal integer: 10432782688332121596508913477221374862484931686020984380032379639612227864482125047503134933841145303511576939537514301549143773046328249803291770058703784235554838502461074037756804915162774582949737436936913250002519775353351299862477438210907381628828105862441647719532618071000601376341979066507562060954
Welcome, admin. Here's your flag: HTB{3mpl0y33s_mu5t_h45h_4ll_m3554g3s_b3f0r3_l00k1ng_4t_th3m_t0_pr3v3nt_bl1ndn3ss}
'''
