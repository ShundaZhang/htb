#if x = x1*x2
#then x^d == x1^d * x2^d

import gmpy2
from re import search as rsearch
from base64 import b64encode, b64decode

r1 = 2644292473
x1 = 2634149185
r2 = 2413332533
x2 = 2395353846
r3 = 2437374463
x3 = 734171532

g = 2654435761

n1 = gmpy2.invert(r1, g)*x1%g
n2 = gmpy2.invert(r2, g)*x2%g
n3 = gmpy2.invert(r3, g)*x3%g

h = n1*n2*n3%g

#print(h)

e,N = 65537, 24655948494154120000542897002593566982109925268950116603401238344387274095371753084726349969395296794535641742345554628818005362346371425515495985743319660664517676752505912255672400931645751263424326074976016157851009260307780763676667690305595390899095154760112723906064292468940148060521130841565099624129652679626799449878740356851612233792758930967297120024277604923406512040333176731247271755850594943608508038515023459006366648994575150787682980545613854590762901311291052258416172647110337782412597686170737873905929031341466494610081420511863471035515090133415577003440586452368929872729907628893963790666249

username = 'System_Administrator'
username = int(username.encode().hex(), 16)%g

#print(username)

'''
>>> 1804508576*g>>32
1115247629

sage: factor(1115247629)
67 * 16645487

sage: (109*2654435761)>>32
67
sage: (26932964*2654435761)>>32
16645487

'''
#username=109 #m
#username=26932964 #04Jwk3

'''
k = -1
while True:
	k += 1 
	print('-> ', k)
	x = username + k*g
	try:
		h = bytes.fromhex(hex(x)[2:]).decode()
		if rsearch('[^a-zA-Z0-9]', h):
			continue
		else:
			print('=======================================================')
			print(h)
			break

	except:
		continue

'''

n1=int(b64decode('MzYyOTcxMjM2OTMwMDU1MjcyNzgzMDQ4OTA2MzM5Njg4MDc1MTMzMzg0NzE3MjIxOTE5Mjk5MzAyMzIzOTg4NzU5MDEyNjk4OTUyMTEzODcwMjI3NTIxMDgzMzE4MTczMjIzOTA5OTU0ODAyOTMwODUyMTg4NTg0MzM4MDYzOTQ5ODMwMDk5MDczNTQxNDIwOTk1MjY0Njc5MTgxNDAyNTczNTM2OTg2MzA5NTc5NjYxNzMwODAyMzIxMzUyMjA5NzcyMzY2MTg0NDEzNDM3NDEwODA5OTk4ODk3MjMyNTIzMjU0MDAwNjIwOTQwNjU2NTkwMDkzNTU4MDgyNDM1NDYwNTE1NTk0MTAxODYyODAyOTU2NTA3NjgxNTk4MTQxNTkxMTE0NDEyMjUzMjIzMDM5Nzg2NTU2MTEwMTI1Mjc1MTMxNjAzMzEwMDEzMzUzMDIyMTkwMzc3MTYyNDg1OTE3MjIzNDM1MDMwMzQ3MDcyNjQ4MDA1MzI2OTkwNTkzNjM3OTExMzQ2MzExODAxMDQ1MjIyNzcxNjMyNjUzNTY2NzgwMDQ4MDU4NDE4MDgxOTQ0OTcyNzg4NDc5NzYwMjkyODkwOTc0OTM0MjQ1Nzc5Njk3NjAwOTA1NDUwOTY5ODg3Mzc2MjQxODM4NTE1MTU4NDMxMTQyMjIxMzc1OTY2ODkzMzIzODYxMjc5NzU5NTQ5NjY5MDM0MTE0MTMzNDI4MTA5MzgwMzAwMDY5ODg2MjI5ODI1MDU3NDU3Nzg1Mzg5NDg0MTMwMjMzNTU4NjkyNjM1ODkyMDgxODMyMTg0MjIwMTg4'))

n2=int(b64decode('MTk2NzM2MzcyOTg1NDIyNjAwMTA3Njg1NDI2NjU0Mzc2MzkyNzU5ODc2NTY4NjgzODU4NzQxMTU5NDc2MTA1NzQwMjA2ODgwNTAyNTM3NDE2OTMxMzQxMzc1MzE5MDI2NzA4ODU5OTY0MzYwNTMxMTY5MjgzNTg1MjQyMzYzMzg5NDc0NTEyNjY4OTc1ODg2NDgyNTU4ODgwMzc2MTc4MjE1OTQ0MzE2NjIxMzY5OTY2ODczMzg0MTYxNzQyNjY3Nzk0MjMwNDI0OTAzNDAyMTYyOTg0NzYwNDE2OTU2NjU2MDk2MzgzMjg3MDUzOTY3NTYxNzU5MjI5MzU2NDY3OTM2NjU4NTIxNzQ2NjE5NzA0NTQzMjA1ODIwMjc4OTM5OTg3NTY2NTEzNjQ0NDc0NTU1Njk3MDE4MDIxNjgyNzk4MDE4NDU4OTAwMTgwMzM0MzI0NTk4MjQyNDU2NzgxMzgzMDQ5OTE4MTc4ODkwNTk4Nzk5ODE5OTY1MTMzMzMyNjU3NTc1NDQyMTM1MjcxNTAzODA1NjMwNzMwNDcwNjQ3NDQ2MjMyNDg2NTcxODM2ODc5MTI2OTYwMTEzNDU5NzI0MzUzNjMyOTY5ODU2NjQxOTMyODc3MTA0OTk4NDYwMzExNTYyMTE0NDI5MDcwOTczMzc0Mjg0NzA3MzIzMTA1MzAyNzk1MDQyODc4OTI5MjY3NDE3OTkxNDE2NTM1MTY2OTE0NDg4MjA4MzA4NTc4MjUzNzU2OTYyNDc5NDgxNjA0NTYwNzY0Nzg0NzI0OTI4ODYxMjEwMjAyMTQ5MjUwNDM1MzU5MzQ='))

print(b64encode(str(n1*n2%N).encode()))

'''
An improved signing server with extra security features such as hashing usernames to avoid forging tokens!
Available options:

[0] Register an account.
[1] Login to your account.
[2] PublicKey of current session.
[3] Exit.

[+] Option >> 2

To avoid disclosing public keys to bots, a modern captcha must be completed. Kindly compute the hash of 'N' to get the full public key based on the following equations:
['equation(unknown, 2644292473, 2654435761) = 2634149185', 'equation(unknown, 2413332533, 2654435761) = 2395353846', 'equation(unknown, 2437374463, 2654435761) = 734171532']

Enter the hash(N): 1251997834
[+] Captcha successful!
(e,N) = (65537, 24655948494154120000542897002593566982109925268950116603401238344387274095371753084726349969395296794535641742345554628818005362346371425515495985743319660664517676752505912255672400931645751263424326074976016157851009260307780763676667690305595390899095154760112723906064292468940148060521130841565099624129652679626799449878740356851612233792758930967297120024277604923406512040333176731247271755850594943608508038515023459006366648994575150787682980545613854590762901311291052258416172647110337782412597686170737873905929031341466494610081420511863471035515090133415577003440586452368929872729907628893963790666249)

An improved signing server with extra security features such as hashing usernames to avoid forging tokens!
Available options:

[0] Register an account.
[1] Login to your account.
[2] PublicKey of current session.
[3] Exit.

[+] Option >> 1
Enter your username: System_Administrator
Enter your authentication token: MTM2ODk2Njg4NDAxODkzNDE0OTg0OTA5NzQ4NDY5MzIzMTU0MzQwMTc5NjUyNTQxNDM0MDQwNzgxODUyODUzNzQyNDIyNzEyMzQwOTA2MDcyMjY5MTcyNjYzNjgwMjY0Njk4MTk1NDUyMzY4NDYzNTYxNzc5ODY4NDMwNTY1NTYwMjE2MjA1ODg1MTAzMDE4MzgyNjI3MjA1Njk1NTYxNjk4MzY2ODk0MjY1MjU3ODk0MzIxNDcxMTExODAyODQ5MDE0MDU2MjE2NTAzOTQ3OTgyNzc5ODYyNzExNjA5MzM3ODEzNTE4NTE4OTIxMTM3ODM5MTgxMDk5MTQ5NjE5OTQ1NTk1NDkyMjE2Mjc4ODQwODE2Mjg1MzUyNzM0MDMzMzU5ODE4MzI0ODg1Mzg4NjU0NjY0Mjk0MTA5MzgxNDA4NjM5MTc5NjIzNDE1ODIyMTE5OTIwNDAzNTI0NzY0MTg2MDI5ODE2MDQ5Mzc4OTU0Mjk2MDEyMDM0MDE5MzUxMTc3MTk0Mzk2ODc1MzExNDQzMjEzNzg1NzI3NjIzODU4NDQ3MzczOTIwOTczNjI0NjIzOTE2NDk2MjU0MDg1MTY2ODYyNjk1MDA5MjA3MDk1NTUxMDQ1NTE0MzA1ODY0ODM4MjI3NzY1MTE1MTc3MDc3NzI3MDQwNzUyODY2MjA0NzY0MTQ2NzE5NTc1MzU3NTYwODMyODgzMjYxNDMwNjYyNDMxNjYwOTQ1MzcwMTkyMjEyOTYwMDM3MTc0NjI0NzMzNjczNzI3MDUwMDMwNzk3MTQ4MzAxNTg4MjUzMjkxODAxMTY4NzY=
[-] No match found for that (username, token) pair.

An improved signing server with extra security features such as hashing usernames to avoid forging tokens!
Available options:

[0] Register an account.
[1] Login to your account.
[2] PublicKey of current session.
[3] Exit.

[+] Option >> 0
Enter a username: m
Your session token is b'MzYyOTcxMjM2OTMwMDU1MjcyNzgzMDQ4OTA2MzM5Njg4MDc1MTMzMzg0NzE3MjIxOTE5Mjk5MzAyMzIzOTg4NzU5MDEyNjk4OTUyMTEzODcwMjI3NTIxMDgzMzE4MTczMjIzOTA5OTU0ODAyOTMwODUyMTg4NTg0MzM4MDYzOTQ5ODMwMDk5MDczNTQxNDIwOTk1MjY0Njc5MTgxNDAyNTczNTM2OTg2MzA5NTc5NjYxNzMwODAyMzIxMzUyMjA5NzcyMzY2MTg0NDEzNDM3NDEwODA5OTk4ODk3MjMyNTIzMjU0MDAwNjIwOTQwNjU2NTkwMDkzNTU4MDgyNDM1NDYwNTE1NTk0MTAxODYyODAyOTU2NTA3NjgxNTk4MTQxNTkxMTE0NDEyMjUzMjIzMDM5Nzg2NTU2MTEwMTI1Mjc1MTMxNjAzMzEwMDEzMzUzMDIyMTkwMzc3MTYyNDg1OTE3MjIzNDM1MDMwMzQ3MDcyNjQ4MDA1MzI2OTkwNTkzNjM3OTExMzQ2MzExODAxMDQ1MjIyNzcxNjMyNjUzNTY2NzgwMDQ4MDU4NDE4MDgxOTQ0OTcyNzg4NDc5NzYwMjkyODkwOTc0OTM0MjQ1Nzc5Njk3NjAwOTA1NDUwOTY5ODg3Mzc2MjQxODM4NTE1MTU4NDMxMTQyMjIxMzc1OTY2ODkzMzIzODYxMjc5NzU5NTQ5NjY5MDM0MTE0MTMzNDI4MTA5MzgwMzAwMDY5ODg2MjI5ODI1MDU3NDU3Nzg1Mzg5NDg0MTMwMjMzNTU4NjkyNjM1ODkyMDgxODMyMTg0MjIwMTg4'

An improved signing server with extra security features such as hashing usernames to avoid forging tokens!
Available options:

[0] Register an account.
[1] Login to your account.
[2] PublicKey of current session.
[3] Exit.

[+] Option >> 0
Enter a username: 04Jwk3
Your session token is b'MTk2NzM2MzcyOTg1NDIyNjAwMTA3Njg1NDI2NjU0Mzc2MzkyNzU5ODc2NTY4NjgzODU4NzQxMTU5NDc2MTA1NzQwMjA2ODgwNTAyNTM3NDE2OTMxMzQxMzc1MzE5MDI2NzA4ODU5OTY0MzYwNTMxMTY5MjgzNTg1MjQyMzYzMzg5NDc0NTEyNjY4OTc1ODg2NDgyNTU4ODgwMzc2MTc4MjE1OTQ0MzE2NjIxMzY5OTY2ODczMzg0MTYxNzQyNjY3Nzk0MjMwNDI0OTAzNDAyMTYyOTg0NzYwNDE2OTU2NjU2MDk2MzgzMjg3MDUzOTY3NTYxNzU5MjI5MzU2NDY3OTM2NjU4NTIxNzQ2NjE5NzA0NTQzMjA1ODIwMjc4OTM5OTg3NTY2NTEzNjQ0NDc0NTU1Njk3MDE4MDIxNjgyNzk4MDE4NDU4OTAwMTgwMzM0MzI0NTk4MjQyNDU2NzgxMzgzMDQ5OTE4MTc4ODkwNTk4Nzk5ODE5OTY1MTMzMzMyNjU3NTc1NDQyMTM1MjcxNTAzODA1NjMwNzMwNDcwNjQ3NDQ2MjMyNDg2NTcxODM2ODc5MTI2OTYwMTEzNDU5NzI0MzUzNjMyOTY5ODU2NjQxOTMyODc3MTA0OTk4NDYwMzExNTYyMTE0NDI5MDcwOTczMzc0Mjg0NzA3MzIzMTA1MzAyNzk1MDQyODc4OTI5MjY3NDE3OTkxNDE2NTM1MTY2OTE0NDg4MjA4MzA4NTc4MjUzNzU2OTYyNDc5NDgxNjA0NTYwNzY0Nzg0NzI0OTI4ODYxMjEwMjAyMTQ5MjUwNDM1MzU5MzQ='

An improved signing server with extra security features such as hashing usernames to avoid forging tokens!
Available options:

[0] Register an account.
[1] Login to your account.
[2] PublicKey of current session.
[3] Exit.

[+] Option >> 1
Enter your username: System_Administrator
Enter your authentication token: NDQ4NDU2Mzk0MDYyOTE5OTIyMzM5MzYzNTAwODM2MzU3NDc5MTczODU1MzE5NDQ4ODcxODc5MTU3NzgwMzAyMzYwOTI1NDMzMTQxMzgxNjkwNjE5NDQ2NTA1MDE5OTA4NTM5NzUxNTQxMTM5MTA1NjkwMjYxMzE0NDI0MzU2NzI2NDY1MzgzMzIxMjg5NDU0NDQwODEyMjM4MzE1NjUzODU3NDQ5MjU2OTE2Mjc4OTY0OTgwMDA4NjI1MjEwMDI5OTY0NDk3MjU3MTUzNzU3NTkwNzAyOTcyNTM4MjA0NDMzNDY5MzA4NDg0NTgxMzcyOTU2NzEyMTA1Mjk0MDg3ODQwODc1NzUzNzc0NjE1OTY0Mjk2NDgzNjgyNTY3OTc0MTU5ODQxMzYwMTc1OTExNzA2MjQwMjE5OTM0NTkyNjEzMTQzMDEwODYwNDM4MTQ0MTA2MDAxMDQ3NDM1NTU5Mzc4MDIxNDM5MTAxODI5ODUwNjkwNjM1ODE1OTY4MTYyMzczMjgyMzI2MTI0ODY0NTg1ODM2MTIwMTc0OTYzODE0Njk4MTkzNjIwMzQxNjM0MTQ4ODkzNzY2NjM2MzMxMzYxMzg2NzA1MDMyNDc4NTg5MjU4MjMyNDU5NDUzNDc4NTg1MTU4NTMwMDM5MjU5MzkyNDM4Mzk3Njk3NjY1NDAxODIwNDE2MTc1MjUwMzQ1MjI4OTYxOTQ0NzIxMjI1Njc4NTA3MDAxMTM2Mzc1MzY3ODE4MTk4NDAyOTk5MTk5NzU2MjQ4NDAwOTk1MDUxMjk5MTc0MTc3NzEyMDYzMTIzNjMxMzYxMw==
[+] Welcome back admin! The note you left behind from your previous session was: HTB{sm4ll_f4c7025_619_p206l3m5}
'''
