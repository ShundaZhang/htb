#https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse-2023/inside-the-matrix/

#p in {17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61}

'''
[[12, 16, 19, 23, 22], [14, 39, 3, 28, 17], [21, 14, 45, 26, 7], [19, 28, 30, 41, 13], [18, 39, 28, 20, 17]]
[[35, 9, 6, 28, 11], [43, 29, 45, 34, 18], [36, 2, 41, 11, 35], [40, 41, 41, 8, 5], [26, 29, 43, 21, 10]]

[[25, 35, 24, 27, 27], [10, 25, 22, 7, 8], [24, 36, 18, 29, 30], [34, 4, 30, 7, 18], [29, 18, 19, 8, 14]]
[[20, 7, 20, 28, 14], [10, 29, 12, 23, 24], [32, 13, 13, 19, 23], [18, 23, 24, 24, 10], [24, 23, 32, 18, 26]]
'''


# This file was *autogenerated* from the file dec.sage
from sage.all_cmdline import *   # import sage library

_sage_const_47 = Integer(47); _sage_const_37 = Integer(37); _sage_const_12 = Integer(12); _sage_const_16 = Integer(16); _sage_const_19 = Integer(19); _sage_const_23 = Integer(23); _sage_const_22 = Integer(22); _sage_const_14 = Integer(14); _sage_const_39 = Integer(39); _sage_const_3 = Integer(3); _sage_const_28 = Integer(28); _sage_const_17 = Integer(17); _sage_const_21 = Integer(21); _sage_const_45 = Integer(45); _sage_const_26 = Integer(26); _sage_const_7 = Integer(7); _sage_const_30 = Integer(30); _sage_const_41 = Integer(41); _sage_const_13 = Integer(13); _sage_const_18 = Integer(18); _sage_const_20 = Integer(20); _sage_const_35 = Integer(35); _sage_const_9 = Integer(9); _sage_const_6 = Integer(6); _sage_const_11 = Integer(11); _sage_const_43 = Integer(43); _sage_const_29 = Integer(29); _sage_const_34 = Integer(34); _sage_const_36 = Integer(36); _sage_const_2 = Integer(2); _sage_const_40 = Integer(40); _sage_const_8 = Integer(8); _sage_const_5 = Integer(5); _sage_const_10 = Integer(10); _sage_const_25 = Integer(25); _sage_const_24 = Integer(24); _sage_const_27 = Integer(27); _sage_const_4 = Integer(4); _sage_const_32 = Integer(32); _sage_const_256 = Integer(256)
p1 = _sage_const_47 
p2 = _sage_const_37 

C1 = matrix(GF(p1), [[_sage_const_12 , _sage_const_16 , _sage_const_19 , _sage_const_23 , _sage_const_22 ], [_sage_const_14 , _sage_const_39 , _sage_const_3 , _sage_const_28 , _sage_const_17 ], [_sage_const_21 , _sage_const_14 , _sage_const_45 , _sage_const_26 , _sage_const_7 ], [_sage_const_19 , _sage_const_28 , _sage_const_30 , _sage_const_41 , _sage_const_13 ], [_sage_const_18 , _sage_const_39 , _sage_const_28 , _sage_const_20 , _sage_const_17 ]])  
K1 = matrix(GF(p1), [[_sage_const_35 , _sage_const_9 , _sage_const_6 , _sage_const_28 , _sage_const_11 ], [_sage_const_43 , _sage_const_29 , _sage_const_45 , _sage_const_34 , _sage_const_18 ], [_sage_const_36 , _sage_const_2 , _sage_const_41 , _sage_const_11 , _sage_const_35 ], [_sage_const_40 , _sage_const_41 , _sage_const_41 , _sage_const_8 , _sage_const_5 ], [_sage_const_26 , _sage_const_29 , _sage_const_43 , _sage_const_21 , _sage_const_10 ]])

C2 = matrix(GF(p2), [[_sage_const_25 , _sage_const_35 , _sage_const_24 , _sage_const_27 , _sage_const_27 ], [_sage_const_10 , _sage_const_25 , _sage_const_22 , _sage_const_7 , _sage_const_8 ], [_sage_const_24 , _sage_const_36 , _sage_const_18 , _sage_const_29 , _sage_const_30 ], [_sage_const_34 , _sage_const_4 , _sage_const_30 , _sage_const_7 , _sage_const_18 ], [_sage_const_29 , _sage_const_18 , _sage_const_19 , _sage_const_8 , _sage_const_14 ]])
K2 = matrix(GF(p2), [[_sage_const_20 , _sage_const_7 , _sage_const_20 , _sage_const_28 , _sage_const_14 ], [_sage_const_10 , _sage_const_29 , _sage_const_12 , _sage_const_23 , _sage_const_24 ], [_sage_const_32 , _sage_const_13 , _sage_const_13 , _sage_const_19 , _sage_const_23 ], [_sage_const_18 , _sage_const_23 , _sage_const_24 , _sage_const_24 , _sage_const_10 ], [_sage_const_24 , _sage_const_23 , _sage_const_32 , _sage_const_18 , _sage_const_26 ]])

F1 = C1 * K1.inverse()
F2 = C2 * K2.inverse()

'''
F1
F2
'''

flag = []

for r1, r2 in zip(F1.rows(), F2.rows()):
    for f1, f2 in zip(r1, r2):
        flag.append(crt([int(f1), int(f2)], [p1, p2]) % _sage_const_256 )

print(bytes(flag))
#b'HTB{l00k_@t_7h3_st4rs!!!}

