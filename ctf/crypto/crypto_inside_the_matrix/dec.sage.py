

# This file was *autogenerated* from the file dec.sage
from sage.all_cmdline import *   # import sage library

_sage_const_59 = Integer(59); _sage_const_23 = Integer(23); _sage_const_17 = Integer(17); _sage_const_37 = Integer(37); _sage_const_13 = Integer(13); _sage_const_25 = Integer(25); _sage_const_54 = Integer(54); _sage_const_52 = Integer(52); _sage_const_50 = Integer(50); _sage_const_24 = Integer(24); _sage_const_38 = Integer(38); _sage_const_32 = Integer(32); _sage_const_40 = Integer(40); _sage_const_12 = Integer(12); _sage_const_45 = Integer(45); _sage_const_30 = Integer(30); _sage_const_14 = Integer(14); _sage_const_34 = Integer(34); _sage_const_42 = Integer(42); _sage_const_48 = Integer(48); _sage_const_21 = Integer(21); _sage_const_0 = Integer(0); _sage_const_4 = Integer(4); _sage_const_31 = Integer(31); _sage_const_33 = Integer(33); _sage_const_19 = Integer(19); _sage_const_49 = Integer(49); _sage_const_16 = Integer(16); _sage_const_9 = Integer(9); _sage_const_46 = Integer(46); _sage_const_2 = Integer(2); _sage_const_6 = Integer(6); _sage_const_18 = Integer(18); _sage_const_22 = Integer(22); _sage_const_15 = Integer(15); _sage_const_7 = Integer(7); _sage_const_5 = Integer(5); _sage_const_11 = Integer(11); _sage_const_20 = Integer(20); _sage_const_10 = Integer(10); _sage_const_8 = Integer(8); _sage_const_256 = Integer(256)#https://7rocky.github.io/en/ctf/other/htb-cyber-apocalypse-2023/inside-the-matrix/

p1 = _sage_const_59 
p2 = _sage_const_23 

C1 = matrix(GF(p1), [(_sage_const_17 , _sage_const_37 , _sage_const_13 , _sage_const_25 , _sage_const_54 ), (_sage_const_37 , _sage_const_52 , _sage_const_50 , _sage_const_24 , _sage_const_52 ), (_sage_const_38 , _sage_const_32 , _sage_const_37 , _sage_const_40 , _sage_const_12 ), (_sage_const_45 , _sage_const_30 , _sage_const_52 , _sage_const_14 , _sage_const_34 ), (_sage_const_14 , _sage_const_42 , _sage_const_48 , _sage_const_21 , _sage_const_37 )])  
K1 = matrix(GF(p1), [(_sage_const_17 , _sage_const_0 , _sage_const_4 , _sage_const_31 , _sage_const_33 ), (_sage_const_54 , _sage_const_19 , _sage_const_49 , _sage_const_24 , _sage_const_54 ), (_sage_const_4 , _sage_const_17 , _sage_const_45 , _sage_const_30 , _sage_const_16 ), (_sage_const_21 , _sage_const_9 , _sage_const_54 , _sage_const_34 , _sage_const_46 ), (_sage_const_33 , _sage_const_13 , _sage_const_2 , _sage_const_6 , _sage_const_12 )])

C2 = matrix(GF(p2), [(_sage_const_13 , _sage_const_13 , _sage_const_9 , _sage_const_9 , _sage_const_18 ), (_sage_const_12 , _sage_const_22 , _sage_const_15 , _sage_const_13 , _sage_const_9 ), (_sage_const_18 , _sage_const_9 , _sage_const_6 , _sage_const_13 , _sage_const_19 ), (_sage_const_21 , _sage_const_19 , _sage_const_17 , _sage_const_4 , _sage_const_19 ), (_sage_const_22 , _sage_const_7 , _sage_const_9 , _sage_const_5 , _sage_const_19 )])
K2 = matrix(GF(p2), [(_sage_const_17 , _sage_const_6 , _sage_const_6 , _sage_const_15 , _sage_const_19 ), (_sage_const_2 , _sage_const_5 , _sage_const_4 , _sage_const_22 , _sage_const_6 ), (_sage_const_5 , _sage_const_11 , _sage_const_13 , _sage_const_5 , _sage_const_20 ), (_sage_const_16 , _sage_const_0 , _sage_const_21 , _sage_const_11 , _sage_const_7 ), (_sage_const_16 , _sage_const_10 , _sage_const_2 , _sage_const_20 , _sage_const_8 )])

F1 = C1 * K1.inverse()
F2 = C2 * K2.inverse()

'''
F1
[13 25  7  5 49]
[48 48 48 36  5]
[57 36 55 45 51]
[36 56 57 52 55]
[56 33 33 33  7]
F2
[ 3 15 20  8 16]
[ 2  2 15  3 18]
[ 1  3  9 12  5]
[ 3  0  1  6 22]
[ 0 10 10 10 10]
'''

flag = []

for r1, r2 in zip(F1.rows(), F2.rows()):
    for f1, f2 in zip(r1, r2):
        flag.append(crt([int(f1), int(f2)], [p1, p2]) % _sage_const_256 )

print(bytes(flag))
#b'HTB{l00k_@t_7h3_st4rs!!!}

