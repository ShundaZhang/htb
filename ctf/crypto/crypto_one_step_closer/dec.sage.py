

# This file was *autogenerated* from the file dec.sage
from sage.all_cmdline import *   # import sage library

_sage_const_0 = Integer(0); _sage_const_2 = Integer(2); _sage_const_0x43df0fbdacf57602b79c3925b4c9f87cd1874cded0a1213ae2802cc0921346371b230b7e7bb8e661c26bb662498f8cd99f2bcfba396c5491e2c4a14aab02424d81be0fadf9a935607592215a9c0ddc05b46a19fd864a42570226cd7fc141b96ee5ab7b362a3c342f0a89e69c581051bbc4fea5e6c06f473d9167acbf65767d4c36c74113f23e1f79dcc18f7e34eb340c227d21011a4a5903992057106edbcd0801ac8a88c902cdf603a98eff768ef6415f4516296d43518f3f3023f9badbe4eec3e6e01be38843b2870a26d5d4cada9f8ea5e5c34a4f2f2e1317fca00527030b1c1f1c4b862bfb730e8fd573874a945e387ad6b80e55438d73cf52d4cd9ea07e = Integer(0x43df0fbdacf57602b79c3925b4c9f87cd1874cded0a1213ae2802cc0921346371b230b7e7bb8e661c26bb662498f8cd99f2bcfba396c5491e2c4a14aab02424d81be0fadf9a935607592215a9c0ddc05b46a19fd864a42570226cd7fc141b96ee5ab7b362a3c342f0a89e69c581051bbc4fea5e6c06f473d9167acbf65767d4c36c74113f23e1f79dcc18f7e34eb340c227d21011a4a5903992057106edbcd0801ac8a88c902cdf603a98eff768ef6415f4516296d43518f3f3023f9badbe4eec3e6e01be38843b2870a26d5d4cada9f8ea5e5c34a4f2f2e1317fca00527030b1c1f1c4b862bfb730e8fd573874a945e387ad6b80e55438d73cf52d4cd9ea07e); _sage_const_0x88b416d85a992d90425be0f32c0db202fd6ceb1c22e6c74b0e8ae358d213e10788ccac98d83a24d2b744408d0129aec25bde5dfa488ea75ef6de5f2e79b252bcb2c419f18de60b5ccd2e551e9b34c641362f3a1e1bf36a2f008fdf6b9f0cb47f9647a3d0c0931fe46c0924e63dcb501885bae16d3cd47ee6f86a7714309bc31ad0e6eae52207ba3e92c589d388ce5f300a869bbfdfd5338a6094f0e88d2c4ad9f8e25f3e0ad2fc211f58ada4069da1ab2441a7fa2d90608cd1324b1ec2c37fba50ae63b24433c947f91a27a14c717a645ea194c0b7e0ff44b8fc909311db7ff2b286cd8d46c811ee49c459e097ff073ce7c0b1888846ffb7f1dfac82536f6ca3 = Integer(0x88b416d85a992d90425be0f32c0db202fd6ceb1c22e6c74b0e8ae358d213e10788ccac98d83a24d2b744408d0129aec25bde5dfa488ea75ef6de5f2e79b252bcb2c419f18de60b5ccd2e551e9b34c641362f3a1e1bf36a2f008fdf6b9f0cb47f9647a3d0c0931fe46c0924e63dcb501885bae16d3cd47ee6f86a7714309bc31ad0e6eae52207ba3e92c589d388ce5f300a869bbfdfd5338a6094f0e88d2c4ad9f8e25f3e0ad2fc211f58ada4069da1ab2441a7fa2d90608cd1324b1ec2c37fba50ae63b24433c947f91a27a14c717a645ea194c0b7e0ff44b8fc909311db7ff2b286cd8d46c811ee49c459e097ff073ce7c0b1888846ffb7f1dfac82536f6ca3); _sage_const_0x101 = Integer(0x101); _sage_const_0x53fdf5d50d7381dccfa77dbb72b495a324544ff3917a72e2620dc78bd49a82d9b21d8b308fe3e448fa10552a3f5c9c5ced7f1afdfe345832974e835896c58cd6483224497c3d5f7a2263597c204e0915e0ec002dc3fe20fd5927fd8217390ee8ed5cb443d1c9fe9dc48931bc5463d62b59b99f934698292018c12e2a3a64edea = Integer(0x53fdf5d50d7381dccfa77dbb72b495a324544ff3917a72e2620dc78bd49a82d9b21d8b308fe3e448fa10552a3f5c9c5ced7f1afdfe345832974e835896c58cd6483224497c3d5f7a2263597c204e0915e0ec002dc3fe20fd5927fd8217390ee8ed5cb443d1c9fe9dc48931bc5463d62b59b99f934698292018c12e2a3a64edea); _sage_const_0x642e4e3eddebd5ae616c5188eed7ece4b8e925fe52985e8a5763b0c6c9ee314318387fba3feee20260d4548264ff9e75d61f0abe5030126f419ea5639dc8b1df4380a5e3b2349d6b883b654a106f658e50bae29a720ecd8a65146e2c2aa6ddca1466b1e2666cdc28d8d35148e598bb183131ee661d2a847cf4039023ff092382 = Integer(0x642e4e3eddebd5ae616c5188eed7ece4b8e925fe52985e8a5763b0c6c9ee314318387fba3feee20260d4548264ff9e75d61f0abe5030126f419ea5639dc8b1df4380a5e3b2349d6b883b654a106f658e50bae29a720ecd8a65146e2c2aa6ddca1466b1e2666cdc28d8d35148e598bb183131ee661d2a847cf4039023ff092382); _sage_const_0x6340399ed74a7bddcac2b5473b2e1ab783adb8d5e5f9756f2bd196c23b4a57fa31a2f1e635e5a3dcd54560d9c04f0323274ec512f6898174ca594138389080e61f82a3cc43e174ddb4eb1eb7cf1ef4ccd5c372d27cae0aa1d4892242dc3118a66c0332d4e8b00a090c2fb0c0573d93f2fbf761de2f2257f06068cc110af8781c8bba78b617e396d171a4de816939f57bdf66c36fe2fdedf663cd1101dd5e2ebd5c4f032c1e3c7174cd15afae0ccecc659f788e80bc17e502a094488f3c15a8407775274a53b605033a709edd07c8fe199c32d19baf25f721abc81e3b3bba600dd0cf9bb5108cf698d621d11bc7f9c32d4e3ef8c380a625730fcc3ab09d2db81 = Integer(0x6340399ed74a7bddcac2b5473b2e1ab783adb8d5e5f9756f2bd196c23b4a57fa31a2f1e635e5a3dcd54560d9c04f0323274ec512f6898174ca594138389080e61f82a3cc43e174ddb4eb1eb7cf1ef4ccd5c372d27cae0aa1d4892242dc3118a66c0332d4e8b00a090c2fb0c0573d93f2fbf761de2f2257f06068cc110af8781c8bba78b617e396d171a4de816939f57bdf66c36fe2fdedf663cd1101dd5e2ebd5c4f032c1e3c7174cd15afae0ccecc659f788e80bc17e502a094488f3c15a8407775274a53b605033a709edd07c8fe199c32d19baf25f721abc81e3b3bba600dd0cf9bb5108cf698d621d11bc7f9c32d4e3ef8c380a625730fcc3ab09d2db81); _sage_const_0x49d9883d07635b47c28808292df77c2e2ebd71f4e233deb33565d6d477de6109421d1f1f2ed5d20205ae1e503ccb667890663f4f004d017d40b8baa576eab3bd7ba4e2db3836b22fc9e255f3c08b7602afdd5d4fc52085330629e47bacc2a8bcaa90f9897f9bbcf3d4eae073f7ddea28dfc0d3852cea4fd68d357149564ef296 = Integer(0x49d9883d07635b47c28808292df77c2e2ebd71f4e233deb33565d6d477de6109421d1f1f2ed5d20205ae1e503ccb667890663f4f004d017d40b8baa576eab3bd7ba4e2db3836b22fc9e255f3c08b7602afdd5d4fc52085330629e47bacc2a8bcaa90f9897f9bbcf3d4eae073f7ddea28dfc0d3852cea4fd68d357149564ef296); _sage_const_0x25660e741462de9adef195d12cc9ffa9b1c65e7e46af8cc73e2f349210a7c708a8b13b1a130eb08026f89017ec20ccbea106bcd835ddb505e52a30d4f68d76593c9a4e0023db3af01c944dfea41e28906be4b08dc0def1cd98cecdf97469f47df99e5956a6457206503bfb18502ccfa8b03cab5f25e289d3006c74641a2ee03e = Integer(0x25660e741462de9adef195d12cc9ffa9b1c65e7e46af8cc73e2f349210a7c708a8b13b1a130eb08026f89017ec20ccbea106bcd835ddb505e52a30d4f68d76593c9a4e0023db3af01c944dfea41e28906be4b08dc0def1cd98cecdf97469f47df99e5956a6457206503bfb18502ccfa8b03cab5f25e289d3006c74641a2ee03e)#Franklin-Reiter Attack
#https://github.com/ashutosh1206/Crypton/blob/master/RSA-encryption/Attack-Franklin-Reiter/exploit.sage

# All the variable names mean the same as mentioned in the explanation
# For eg, a,b are the values in the function f = ax + b

def gcd(a, b):
    while b:
        a, b = b, a % b
    return a.monic()

def franklinreiter(C1, C2, e, N, a1, b1, a2, b2):
    P = PolynomialRing(Zmod(N), names=('X',)); (X,) = P._first_ngens(1)
    g1 = (a1*X + b1)**e - C1
    #g2 = X^e - C2
    g2 = (a2*X + b2)**e - C2
    print("Result: ")
    result = -gcd(g1, g2).coefficients()[_sage_const_0 ]
    return bytes.fromhex(hex(int(result))[_sage_const_2 :])

c1 = _sage_const_0x43df0fbdacf57602b79c3925b4c9f87cd1874cded0a1213ae2802cc0921346371b230b7e7bb8e661c26bb662498f8cd99f2bcfba396c5491e2c4a14aab02424d81be0fadf9a935607592215a9c0ddc05b46a19fd864a42570226cd7fc141b96ee5ab7b362a3c342f0a89e69c581051bbc4fea5e6c06f473d9167acbf65767d4c36c74113f23e1f79dcc18f7e34eb340c227d21011a4a5903992057106edbcd0801ac8a88c902cdf603a98eff768ef6415f4516296d43518f3f3023f9badbe4eec3e6e01be38843b2870a26d5d4cada9f8ea5e5c34a4f2f2e1317fca00527030b1c1f1c4b862bfb730e8fd573874a945e387ad6b80e55438d73cf52d4cd9ea07e 

n = _sage_const_0x88b416d85a992d90425be0f32c0db202fd6ceb1c22e6c74b0e8ae358d213e10788ccac98d83a24d2b744408d0129aec25bde5dfa488ea75ef6de5f2e79b252bcb2c419f18de60b5ccd2e551e9b34c641362f3a1e1bf36a2f008fdf6b9f0cb47f9647a3d0c0931fe46c0924e63dcb501885bae16d3cd47ee6f86a7714309bc31ad0e6eae52207ba3e92c589d388ce5f300a869bbfdfd5338a6094f0e88d2c4ad9f8e25f3e0ad2fc211f58ada4069da1ab2441a7fa2d90608cd1324b1ec2c37fba50ae63b24433c947f91a27a14c717a645ea194c0b7e0ff44b8fc909311db7ff2b286cd8d46c811ee49c459e097ff073ce7c0b1888846ffb7f1dfac82536f6ca3 
e = _sage_const_0x101 

a1 = _sage_const_0x53fdf5d50d7381dccfa77dbb72b495a324544ff3917a72e2620dc78bd49a82d9b21d8b308fe3e448fa10552a3f5c9c5ced7f1afdfe345832974e835896c58cd6483224497c3d5f7a2263597c204e0915e0ec002dc3fe20fd5927fd8217390ee8ed5cb443d1c9fe9dc48931bc5463d62b59b99f934698292018c12e2a3a64edea 

b1 = _sage_const_0x642e4e3eddebd5ae616c5188eed7ece4b8e925fe52985e8a5763b0c6c9ee314318387fba3feee20260d4548264ff9e75d61f0abe5030126f419ea5639dc8b1df4380a5e3b2349d6b883b654a106f658e50bae29a720ecd8a65146e2c2aa6ddca1466b1e2666cdc28d8d35148e598bb183131ee661d2a847cf4039023ff092382 

c2 = _sage_const_0x6340399ed74a7bddcac2b5473b2e1ab783adb8d5e5f9756f2bd196c23b4a57fa31a2f1e635e5a3dcd54560d9c04f0323274ec512f6898174ca594138389080e61f82a3cc43e174ddb4eb1eb7cf1ef4ccd5c372d27cae0aa1d4892242dc3118a66c0332d4e8b00a090c2fb0c0573d93f2fbf761de2f2257f06068cc110af8781c8bba78b617e396d171a4de816939f57bdf66c36fe2fdedf663cd1101dd5e2ebd5c4f032c1e3c7174cd15afae0ccecc659f788e80bc17e502a094488f3c15a8407775274a53b605033a709edd07c8fe199c32d19baf25f721abc81e3b3bba600dd0cf9bb5108cf698d621d11bc7f9c32d4e3ef8c380a625730fcc3ab09d2db81 

a2 = _sage_const_0x49d9883d07635b47c28808292df77c2e2ebd71f4e233deb33565d6d477de6109421d1f1f2ed5d20205ae1e503ccb667890663f4f004d017d40b8baa576eab3bd7ba4e2db3836b22fc9e255f3c08b7602afdd5d4fc52085330629e47bacc2a8bcaa90f9897f9bbcf3d4eae073f7ddea28dfc0d3852cea4fd68d357149564ef296 

b2 = _sage_const_0x25660e741462de9adef195d12cc9ffa9b1c65e7e46af8cc73e2f349210a7c708a8b13b1a130eb08026f89017ec20ccbea106bcd835ddb505e52a30d4f68d76593c9a4e0023db3af01c944dfea41e28906be4b08dc0def1cd98cecdf97469f47df99e5956a6457206503bfb18502ccfa8b03cab5f25e289d3006c74641a2ee03e 

print(franklinreiter(c1, c2, e, n, a1, b1, a2, b2))

