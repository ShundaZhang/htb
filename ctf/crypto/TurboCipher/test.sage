'''
p = 12960974013269109369608452274106570000451808354943304011793109383983633856606194423566823886184029267288406176737449086786410106482326183188221470849231903
b = 12301032043814920228473372250192030355144629389530234465995693680392153897955908720460757695865488624354965797787319529615134388638574752507949038999539693
c = 7836336344426970263578051538172603129689883436726160776690163495198093394071819576883673628660972777998528129807821506710741096988176720535619293420456099

Please, use nonce = 6080797397398478704722321740283489064121201839016492821420382563309451417992570063294748268414234431961052952323285621201099634996628059175422732135956724 to generate for your TurbOTP
'''

#https://www.wolframalpha.com/input?i=f%28n%29%3Dc*f%28n-2%29%2Bb*f%28n-1%29%2C+f%280%29%3D0%2C+f%281%29%3D1

def calc(n,b,c,p):
	return int(((2^(-n)*((sqrt(b^2 + 4*c) + b)^n - (b - sqrt(b^2 + 4*c))^n))/sqrt(b^2 + 4*c)))%p

p = 12960974013269109369608452274106570000451808354943304011793109383983633856606194423566823886184029267288406176737449086786410106482326183188221470849231903
b = 12301032043814920228473372250192030355144629389530234465995693680392153897955908720460757695865488624354965797787319529615134388638574752507949038999539693
c = 7836336344426970263578051538172603129689883436726160776690163495198093394071819576883673628660972777998528129807821506710741096988176720535619293420456099
n = 6080797397398478704722321740283489064121201839016492821420382563309451417992570063294748268414234431961052952323285621201099634996628059175422732135956724

#print(int(calc(n,b,c,p))) #too large! OverflowError: exponent must be at most 9223372036854775807
#print(calc(1024,100,300,2^64+1))

m = matrix(GF(p), [[0,1], [c,b]])
x0 = 0
x1 = 1
m = m^n

result = m*vector([x0, x1])

print(result)

