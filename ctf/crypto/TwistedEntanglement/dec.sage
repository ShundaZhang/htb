p = 115792089237316195423570985008687907853269984665640564039457584007908834671663
a = 0
b = 6
EC = EllipticCurve(GF(p), [a, b])

'''
sage: P = EC.random_point()
sage: P.xy()
(47576985668603091288409909735618892149216526162497318226980791311961206097676,
 66648133644675328856907379771703795028547965918393913332753625274196414849912)
sage: P.order()
4135431758475578407984678036024568137640761304218723702974166807307342139253

sage: factor(4135431758475578407984678036024568137640761304218723702974166807307342139253)
7 * 10903 * 5290657 * 10833080827 * 22921299619447 * 41245443549316649091297836755593555342121

Enter your point x,y: 47576985668603091288409909735618892149216526162497318226980791311961206097676,66648133644675328856907379771703795028547965918393913332753625274196414849912

Here's your new Public Key: [14136777349097208849854333917884541158548754463600418287629239538227257499639, 95344308238761697040392396859453526132501192364571913344919827393100314777726]
'''

Gx, Gy = 47576985668603091288409909735618892149216526162497318226980791311961206097676,66648133644675328856907379771703795028547965918393913332753625274196414849912
Qx, Qy = 14136777349097208849854333917884541158548754463600418287629239538227257499639, 95344308238761697040392396859453526132501192364571913344919827393100314777726

G = EC(Gx, Gy)
Q = EC(Qx, Qy)

primes = [7,10903,5290657,10833080827,22921299619447,41245443549316649091297836755593555342121]
#primes = primes[:-1] #3262827136301000405966
primes = primes[:-2]  #3262827136301000405966
#primes = primes[:-3] #Error 63994675020
dlogs = []

'''
factor: 7, Discrete Log: 3
factor: 10903, Discrete Log: 7155
factor: 5290657, Discrete Log: 4178605
factor: 10833080827, Discrete Log: 6268212901
factor: 22921299619447, Discrete Log: 8239490016515
'''
for fac in primes:
	#t = int(G.order())//int(fac)
	t = 4135431758475578407984678036024568137640761304218723702974166807307342139253//fac
	dlog = discrete_log(t*Q, t*G, operation='+')
	dlogs += [dlog]
	print("factor: "+str(fac)+", Discrete Log: "+str(dlog)) #calculates discrete logarithm for each prime order

private_key = crt(dlogs, primes)
print(private_key)
#3262827136301000405966
