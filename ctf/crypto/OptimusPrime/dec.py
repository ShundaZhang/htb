import gmpy2

n1 = 330254318552789612255895757817205424285205762145107654420046503535399410731038250397518995050945824128807919267790023502021323535836421702735545137594617665793855130473354274608405587504153336636581955784298011350231811986281591206212472794462815840452679661715237017831727651926900679476391393652103616271160541811852993232330938753010278764513364556627955111524968047730052011619264414839068649131551083946544600362026325561948272783406278708809876501364744583183343849582222884973663950148280297527520555734043953537939940930641469893108235016896739183940002958035390652786684885531867752960086422077312538978569963796164329756672769474776039371304497574583814687827707651691530510928413589103664034898896427777261243171234804870411604632826128683368311596694516433982271985033048552021995442517663330286209675530680780567233559527987259479308097853352765942773973017323708776419477294086728995437892381998815667201462632396082748185476419848568517097763769726978654028680679232945432435146958005625365349533546470414294357819452215767698604908183868601210405937217003922880664943562147098265829828665204871051291508938196060513327200982309571769791712900843618552068163443046859985034713872784509276394757861584679587160120039029
c1 = 185305824295936708552114062721377378034359326739253165196019469232144662057717198863825225962093531740775925076396536056784705046030012974248889516671620227456006703498565668643340303773717469812775493788887589227087071767809925099404366686865916182545882712718072995046082068050539609049218015119079740975056043340715985642469042096489021941043000706327297023855606200722989167024172655062729868630646743378820968592621581176413417468815754389295932388298273367898157085078870196093733524120376826887273400054397384133943072494987851152049107824715151743751217837351402469775606190094066905822469649053728150819001969542543537151258937637446323276413331794152033019871908993835432124912206031976294611212004819775349839012021473396609861942717104722543936293710827402060686386696787343273769176829021582250053906384496158524932921666512638697803734121594824654771735719110388245954210995478015559470095200146363643722387007994733864989182727346104595506967273368412831545744669134878403004649922800144208297546878167803766802095976626838390581093035381337396604803160023798727292826277730762251906017451153934569144073057124323905297690027894863845149048554420699501066073209233667582598399066537339526106378146510522111790179857728

n2 = 416571180949258981675663031533744871520685434687124502157246059563616952604752324925832696857159179177091979564072297087715234936053095657119942657260456900885488981821640089028023089421832761084296726830910301338830912032733203383143674400926738345627574258405961218575994664925910627192567171678448184971231504815444927975316207988674985604850068650314295705929388411793536197876809697681660821379344656649495069997763515755301996715239833423591913842412424922253138766105003265207684572671386045326646200170609804304864429805887950967818279344428664243918513346032796782495748905041224115511235549466696069315467926855450335064328377970443554938192375815878249633817628764114237648697758073101084809049918872192218181216930642219925179697552720232211951053667344212070583918204452751115485369758262768293555958692677020753689997318618282724367848580112531194886246689904371888316038072935985414316208334666428967635193567248356554063845600728014445516442239792371440030349535887432750116546897631056242326332923707854744655851436171579209890477435880060589424611027919604473120049365583083738733154101178092513737569006636826089277316096318681263483397088659578812596562557933775173507105808404426798898029870620155060575079910709
c2 = 36629792855216558701030738473649256744804274776354409021478616029205306118147278820071809889625590679966960116905816031670035614118639557801198210822165206926964626532866013677398147610951861907770162272000216044375847435773024595349201887226859515501644611714742651934036934531782330720943955107311621485265550963789459585500167311536791091056589273233615619431885871197473569361627420006201225556262835295832156114980671132765622130983478376274538123138603792725538288683990334621788820916234063544400147244077677834464066288932453958985503998996601772293696708680532748366341440539860542226062186209238154216635121529405116142973715716164268763751404888734506813088173626459385774620746607241519847007297422012883593752275073698430638310722731622137102893120969233405038654057754673895370880616737852562442850842399415088904700506997212360493775002040176152239406219561107913932536237084512255867653742119550774796212006868297205111131957188564447594568256635599289624802365215826000793964478938710665847324690833310764039766015344062984093569951194538742589962440002330755896453458926238782987049293207465056108959773030487789401423110970225334176571388481942915409544670061413238299348153566908961506913759216645375605052890612

e = 65537

def gcd(a, b):
    if a < b:
        a, b = b, a
    while b != 0:
        temp = a % b
        a = b
        b = temp
    return a

p = gcd(n1, n2)
q = n1/p

phi = (p-1)*(q-1)
d = gmpy2.invert(e,phi)

m = pow(c1, d, n1)
print hex(m)[2:].decode('hex')

q2 = n2/p
phi2 = (p-1)*(q2-1)
d2 = gmpy2.invert(e,phi2)
m2 = pow(c2, d2, n2)
print hex(m2)[2:].decode('hex')

'''
root@ubuntu-s-1vcpu-1gb-sfo2-01:~/ctf/CTF# nc 134.209.17.29 30688
There’s only one way to deal with this, and that’s to stomp it flat.
1. View status of the Transformer.
2. View Serial ID's of the Transformer.
3. Register new Transformer.
4. Enter to the access panel.
Enter the option: 4
PUBLIC KEY: 416571180949258981675663031533744871520685434687124502157246059563616952604752324925832696857159179177091979564072297087715234936053095657119942657260456900885488981821640089028023089421832761084296726830910301338830912032733203383143674400926738345627574258405961218575994664925910627192567171678448184971231504815444927975316207988674985604850068650314295705929388411793536197876809697681660821379344656649495069997763515755301996715239833423591913842412424922253138766105003265207684572671386045326646200170609804304864429805887950967818279344428664243918513346032796782495748905041224115511235549466696069315467926855450335064328377970443554938192375815878249633817628764114237648697758073101084809049918872192218181216930642219925179697552720232211951053667344212070583918204452751115485369758262768293555958692677020753689997318618282724367848580112531194886246689904371888316038072935985414316208334666428967635193567248356554063845600728014445516442239792371440030349535887432750116546897631056242326332923707854744655851436171579209890477435880060589424611027919604473120049365583083738733154101178092513737569006636826089277316096318681263483397088659578812596562557933775173507105808404426798898029870620155060575079910709
ENCRYPTED PASSWORD: 36629792855216558701030738473649256744804274776354409021478616029205306118147278820071809889625590679966960116905816031670035614118639557801198210822165206926964626532866013677398147610951861907770162272000216044375847435773024595349201887226859515501644611714742651934036934531782330720943955107311621485265550963789459585500167311536791091056589273233615619431885871197473569361627420006201225556262835295832156114980671132765622130983478376274538123138603792725538288683990334621788820916234063544400147244077677834464066288932453958985503998996601772293696708680532748366341440539860542226062186209238154216635121529405116142973715716164268763751404888734506813088173626459385774620746607241519847007297422012883593752275073698430638310722731622137102893120969233405038654057754673895370880616737852562442850842399415088904700506997212360493775002040176152239406219561107913932536237084512255867653742119550774796212006868297205111131957188564447594568256635599289624802365215826000793964478938710665847324690833310764039766015344062984093569951194538742589962440002330755896453458926238782987049293207465056108959773030487789401423110970225334176571388481942915409544670061413238299348153566908961506913759216645375605052890612
The private key has been sent to your email. Please use it to proceed: tdjfzpmitne
ACCESS GRANTED: HTB{3uc1id_w4z_th3_pr1me_h4x0r}
'''
