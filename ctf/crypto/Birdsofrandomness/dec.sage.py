
# This file was *autogenerated* from the file dec.sage
from sage.all_cmdline import *   # import sage library

_sage_const_3 = Integer(3); _sage_const_2 = Integer(2); _sage_const_3113111 = Integer(3113111); _sage_const_43054831 = Integer(43054831); _sage_const_49 = Integer(49); _sage_const_14807290861072031659976937040569354 = Integer(14807290861072031659976937040569354); _sage_const_12952516339987872946099866597314047 = Integer(12952516339987872946099866597314047); _sage_const_176489 = Integer(176489); _sage_const_5140071671361386753880669417781067 = Integer(5140071671361386753880669417781067); _sage_const_3761 = Integer(3761); _sage_const_439693 = Integer(439693); _sage_const_17101937747109687265202713197737423 = Integer(17101937747109687265202713197737423); _sage_const_3543321030468950376213178213609418 = Integer(3543321030468950376213178213609418); _sage_const_1487 = Integer(1487)

M = _sage_const_17101937747109687265202713197737423 
A = _sage_const_2 
B = _sage_const_3 
F = FiniteField(M)
E = EllipticCurve(F,[A,B])

P = (_sage_const_3543321030468950376213178213609418 , _sage_const_14807290861072031659976937040569354 )
Q = (_sage_const_5140071671361386753880669417781067 , _sage_const_12952516339987872946099866597314047 )

P = E.point(P)
Q = E.point(Q)
print(P.order())

#17101937747109687496599931614463506 = 2 * 3 * 7^2 * 1487 * 3761 * 176489 * 439693 * 3113111 * 43054831
primes = [_sage_const_2  , _sage_const_3  , _sage_const_49 , _sage_const_1487  , _sage_const_3761  , _sage_const_176489  , _sage_const_439693  , _sage_const_3113111  , _sage_const_43054831 ]

dlogs = []
for fac in primes:
	t = int(P.order()) / int(fac)
	dlog = discrete_log(t*Q, t*P, operation="+")
	dlogs += [dlog]
	print("factor: "+str(fac)+", Discrete Log: "+str(dlog)) #calculates discrete logarithm for each prime order

d = crt(dlogs, primes)
print(d)

